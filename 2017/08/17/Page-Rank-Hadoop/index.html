<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Page Rank - Hadoop | Ankai Liang's Blog</title><noscript>Please enable JavaScript to view the site</noscript><link rel="icon" href="/img/pwa/favicon.png"><!-- index.css--><link rel="stylesheet" href="/css/index.css?v=1.7.8"><!-- inject head--><link rel="stylesheet" href="https://cdn2.codesign.qq.com/icons/7pOrz0WXB5ZWJPX/latest/iconfont.css"><!-- aplayer--><!-- swiper--><!-- Open Graph--><meta name="description" content="Page Rank by hadoop"><!-- pwa--><script>(win => {
        win.saveToLocal = {
            set: function setWithExpiry(key, value, ttl) {
                if (ttl === 0)
                    return
                const now = new Date()
                const expiryDay = ttl * 86400000
                const item = {
                    value: value,
                    expiry: now.getTime() + expiryDay,
                }
                localStorage.setItem(key, JSON.stringify(item))
            },

            get: function getWithExpiry(key) {
                const itemStr = localStorage.getItem(key)

                if (!itemStr) {
                    return undefined
                }
                const item = JSON.parse(itemStr)
                const now = new Date()

                if (now.getTime() > item.expiry) {
                    localStorage.removeItem(key)
                    return undefined
                }
                return item.value
            }
        }

        const DarkModeStatus = localStorage.getItem('theme')
        if (DarkModeStatus !== null) {
            if (DarkModeStatus === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark')
            } else {
                document.documentElement.setAttribute('data-theme', 'light')
            }
        }

        const asideStatus = saveToLocal.get('aside-status')
        if (asideStatus !== undefined) {
            if (asideStatus === 'hide') {
                document.documentElement.classList.add('hide-aside')
            } else {
                document.documentElement.classList.remove('hide-aside')
            }
        }

        win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
            const link = document.createElement('link')
            link.rel = 'stylesheet'
            link.href = url
            if (id) link.id = id
            link.onerror = reject
            link.onload = link.onreadystatechange = function () {
                const loadState = this.readyState
                if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
                link.onload = link.onreadystatechange = null
                resolve()
            }
            document.head.appendChild(link)
        })

        win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
            const script = document.createElement('script')
            script.src = url
            script.async = true
            script.onerror = reject
            script.onload = script.onreadystatechange = function () {
                const loadState = this.readyState
                if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
                script.onload = script.onreadystatechange = null
                resolve()
            }

            Object.keys(attr).forEach(key => {
                script.setAttribute(key, attr[key])
            })

            document.head.appendChild(script)
        })
    }
)(window)

console.log(
    "%c Program: Hexo %c Theme: Solitude %c Version: v1.7.8",
    "border-radius:5px 0 0 5px;padding: 5px 10px;color:white;background:#ff3842;",
    "padding: 5px 10px;color:white;background:#3e9f50;",
    "border-radius:0 5px 5px 0;padding: 5px 10px;background:#0084ff;color:white;"
);</script><!-- global head--><script>const GLOBAL_CONFIG = {
    root: '/',
    algolia: undefined,
    localsearch: undefined,
    runtime: '2017-02-20 00:00:00',
    lazyload: {
        enable: false,
        error: '/img/error_load.png'
    },
    copyright: false,
    highlight: {
        enable: true,
        limit: 200,
        expand: true,
        copy: true,
        syntax: 'highlight.js'
    },
    randomlink: false,
    lang: {"theme":{"dark":"dark","light":"light"},"copy":{"success":"Copied","error":"Copied failed"},"backtop":"Back to top","time":{"day":" days ago","hour":" hours ago","just":"just","min":" minutes ago","month":" months ago"},"f12":"Developer mode is turned on, please follow the GPL."},
    aside: {
        sayhello: {
            morning: '一日之计在于晨',
            noon: '吃饱了才有力气干活',
            afternoon: '集中精力，攻克难关',
            night: '不要太劳累了，早睡更健康',
            goodnight: '睡个好觉，保证精力充沛',
        },
        sayhello2: [],
    },
    covercolor: {
        enable: false
    },
    comment: {"avatar":"https://cravatar.cn","url":"https://waline-comment-five-smoky.vercel.app/","commentBarrage":true,"owo":{"body":".wl-emoji-popup","item":".wl-tab-wrapper button"}},
    lightbox: 'null',
    post_ai: {"key":"4ec1f0c37662c32a09a0","talk":"我是 Efu 开发的摘要生成助理EfuGPT，EfuGPT在静态部署时进行摘要的撰写，并且在访客访问时通过EfuCorrection转译后的文本摘要实现工具。我在这里只负责已经生成的摘要显示，你无法与我直接沟通，但我可以回答一些预设的问题。","randomPost":true}
};</script><meta name="generator" content="Hexo 7.1.1"></head><body id="body"><!-- universe--><canvas id="universe"></canvas><!-- loading--><!-- console--><div id="console"><div class="close-btn" onclick="sco.hideConsole()"><i class="solitude st-close-fill"></i></div><div class="button-group"><div class="console-btn-item"><span class="darkmode_switchbutton" onclick="sco.switchDarkMode()" title="Day and night switching"><i class="solitude st-moon-clear-fill"></i></span></div><div class="console-btn-item" id="consoleHideAside"><span class="asideSwitch" onclick="sco.switchHideAside()" title="Sidebar display control"><i class="solitude st-side-bar-fill"></i></span></div></div><div class="console-mask" onclick="sco.hideConsole()"></div></div><!-- sidebar--><div id="sidebar" style="zoom: 1;"><div id="menu-mask" style="display: none;"></div><div id="sidebar-menus"><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Archives</div><div class="length-num">11</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">5</div></a></div></div></div><span class="sidebar-menu-item-title">Function</span><div class="sidebar-menu-item"><span class="darkmode_switchbutton menu-child" onclick="sco.switchDarkMode()"><i class="solitude st-moon-clear-fill"></i><span>Display mode</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span>Home</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>Articals</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="solitude  st-folder-fill"></i><span>Artical List</span></a></li><li><a class="site-page child" href="/tags/"><i class="solitude  st-price-tag-fill"></i><span>All tags</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><span>About</span></a></div></div><span class="sidebar-menu-item-title">Tags</span><div class="card-widget card-tags card-archives card-webinfo card-allinfo"><div class="card-tag-cloud"><a href="/tags/Distrubute-System/">Distrubute System<sup>2</sup></a><a href="/tags/System-Administration/">System Administration<sup>6</sup></a><a href="/tags/AI/">AI<sup>2</sup></a><a href="/tags/Search-Infra/">Search Infra<sup>1</sup></a><a href="/tags/AI-Search-Infra/">AI, Search Infra<sup>0</sup></a></div></div></div></div><!-- keyboard--><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav class="show" id="nav"><div id="nav-group"><div id="blog_name"><a id="site-name" href="/" title="Back to home"><span class="title">Ankai Liang / ex-Googler / ByteDancer</span></a></div><div id="page-name-mask"><div id="page-name"><a id="page-name-text" onclick="sco.toTop()">Page Rank - Hadoop</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span>Home</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>Articals</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="solitude  st-folder-fill"></i><span>Artical List</span></a></li><li><a class="site-page child" href="/tags/"><i class="solitude  st-price-tag-fill"></i><span>All tags</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><span>About</span></a></div></div></div><div id="nav-left"></div><div id="nav-right"><div class="nav-button" id="nav-totop" onclick="sco.toTop()"><a class="totopbtn"><i class="solitude st-arrow-up-line"></i><span id="percent">0</span></a></div><div id="toggle-menu"><a class="site-page"><i class="solitude st-menu-line"></i></a></div></div></div></nav><div class="coverdiv" id="coverdiv"><img class="nolazyload" id="post-cover" src="/img/default3.png" alt="Page Rank - Hadoop"></div><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original" title="This article is a Original article, pay attention to the copyright.">Original</a><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Distrubute-System/"><span class="tags-name tags-punctuation">Distrubute System</span></a></div></div></div></div><h1 class="post-title">Page Rank - Hadoop</h1><div id="post-meta"><div class="meta-secondline"></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><div class="post-ai"><div class="ai-title"><div class="ai-title-left"><i class="ai-title-icon solitude st-robot-fill"></i><div class="ai-title-text">文章摘要</div></div><div class="ai-tag" id="ai-tag">GPT 4</div></div><div class="ai-explanation" style="display: block;"></div><div class="ai-suggestions"></div><div class="ai-bottom"><div class="ai-tips"></div></div></div><article class="post-content" id="article-container"><h1 id="PageRank-Hadoop"><a href="#PageRank-Hadoop" class="headerlink" title="PageRank-Hadoop"></a>PageRank-Hadoop</h1><ul>
<li>Ankai Liang</li>
<li>10411998</li>
<li>CS 549 Assignment 5</li>
<li><a target="_blank" rel="noopener" href="https://github.com/AnkaiLiang/Page-Rank-Hadoop">code link</a></li>
</ul>
<h2 id="Code-Explanation"><a href="#Code-Explanation" class="headerlink" title="Code Explanation"></a>Code Explanation</h2><h3 id="PageRankDriver-java"><a href="#PageRankDriver-java" class="headerlink" title="PageRankDriver.java"></a>PageRankDriver.java</h3><p>In this snippet, I print my name in the method <code>composite()</code>, write another <code>composite()</code> to deal with the order which contains an equipartitioned join. And I change the code in <code>summarizeResult()</code> in order to output the result with an equipartitioned join.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PageRankDriver</span> &#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">double</span> <span class="variable">DECAY</span> <span class="operator">=</span> <span class="number">0.85</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">MARKER_DELIMITER</span> <span class="operator">=</span> <span class="string">&quot;+&quot;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">MARKER_ADJ</span> <span class="operator">=</span> <span class="string">&quot;ADJACENCY&quot;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">nameInput</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">	<span class="type">String</span> <span class="variable">job</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">	...</span><br><span class="line">	 <span class="keyword">else</span> <span class="keyword">if</span> (args.length == <span class="number">7</span>) <span class="comment">// If number of input arguments is 7 and</span></span><br><span class="line">									<span class="comment">// first input is == &quot;composite&quot;; parses</span></span><br><span class="line">									<span class="comment">// data to composite</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (job.equals(<span class="string">&quot;composite&quot;</span>)) &#123;</span><br><span class="line">			composite(args[<span class="number">1</span>], args[<span class="number">2</span>], args[<span class="number">3</span>], args[<span class="number">4</span>], args[<span class="number">5</span>],</span><br><span class="line">					Integer.parseInt(args[<span class="number">6</span>]));</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="comment">// In case the function name doesn&#x27;t match up</span></span><br><span class="line">		&#123;</span><br><span class="line">			System.err</span><br><span class="line">					.println(<span class="string">&quot;Please check the name of the function you wish to call and try again&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (args.length == <span class="number">8</span>) <span class="comment">// If number of input arguments is 8 and</span></span><br><span class="line">		<span class="comment">// first input is == &quot;composite&quot;; parses</span></span><br><span class="line">		<span class="comment">// data to composite</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (job.equals(<span class="string">&quot;composite&quot;</span>)) &#123;</span><br><span class="line">			composite(args[<span class="number">1</span>], args[<span class="number">2</span>], args[<span class="number">3</span>], args[<span class="number">4</span>], args[<span class="number">5</span>], args[<span class="number">6</span>],</span><br><span class="line">					Integer.parseInt(args[<span class="number">7</span>]));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	...</span><br><span class="line">	</span><br><span class="line">			<span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">1</span>) <span class="comment">// As i increments at the last step, for odd i, interim2</span></span><br><span class="line">					<span class="comment">// is the input directory</span></span><br><span class="line">	&#123;</span><br><span class="line">		deleteDirectory(interim1); <span class="comment">// deletes other directory</span></span><br><span class="line">		counter++;</span><br><span class="line">		<span class="keyword">if</span> (nameInput != <span class="literal">null</span>) &#123;</span><br><span class="line">			translate(nameInput, interim2, interim1, reducers);</span><br><span class="line">			finish(interim1, output, reducers);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			finish(interim2, output, reducers);</span><br><span class="line">		&#125;</span><br><span class="line">		summarizeResult(output);</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="comment">// for even i, interim1 is the input directory</span></span><br><span class="line">	&#123;</span><br><span class="line">		deleteDirectory(interim2); <span class="comment">// Deletes other directory</span></span><br><span class="line">		counter++;</span><br><span class="line">		<span class="keyword">if</span> (nameInput != <span class="literal">null</span>) &#123;</span><br><span class="line">			translate(nameInput, interim1, interim2, reducers);</span><br><span class="line">			finish(interim2, output, reducers);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			finish(interim1, output, reducers);</span><br><span class="line">		&#125;</span><br><span class="line">		summarizeResult(output);</span><br><span class="line">	&#125;</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">composite</span><span class="params">(String input, String output, String interim1,</span></span><br><span class="line"><span class="params">		String interim2, String diff, <span class="type">int</span> reducers)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * TODO </span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	System.out.println(<span class="string">&quot;Ankai Liang (10411998)&quot;</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="type">int</span> <span class="variable">counter</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">composite</span><span class="params">(String name, String input, String output, String interim1,</span></span><br><span class="line"><span class="params">		String interim2, String diff, <span class="type">int</span> reducers)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">	nameInput = name;</span><br><span class="line">	composite(input, output, interim1, interim2, diff, reducers);</span><br><span class="line">	nameInput = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">summarizeResult</span><span class="params">(String path)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">	<span class="type">Path</span> <span class="variable">finpath</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Path</span>(path); <span class="comment">// Creates new Path</span></span><br><span class="line">	<span class="type">Configuration</span> <span class="variable">conf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line">	<span class="type">FileSystem</span> <span class="variable">fs</span> <span class="operator">=</span> FileSystem.get(URI.create(path), conf);</span><br><span class="line">	HashMap&lt;String, Double&gt; values = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, Double&gt;(); </span><br><span class="line">	...</span><br></pre></td></tr></table></figure>

<h3 id="InitMapper-java"><a href="#InitMapper-java" class="headerlink" title="InitMapper.java"></a>InitMapper.java</h3><ul>
<li>input:   nodeIdentifier : adjacency list</li>
<li>emit:   key &#x3D; nodeIdentifier, value &#x3D; adjacency list</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InitMapper</span> <span class="keyword">extends</span> <span class="title class_">Mapper</span>&lt;LongWritable, Text, Text, Text&gt; &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">map</span><span class="params">(LongWritable key, Text value, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException,</span><br><span class="line">			IllegalArgumentException &#123;</span><br><span class="line">		<span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> value.toString(); <span class="comment">// Converts Line to a String</span></span><br><span class="line">		<span class="comment">/* </span></span><br><span class="line"><span class="comment">		 * <span class="doctag">TODO:</span> Just echo the input, since it is already in adjacency list format.</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		String[] sections = line.split(<span class="string">&quot;:&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span> (sections.length == <span class="number">2</span>)&#123;</span><br><span class="line">			context.write(<span class="keyword">new</span> <span class="title class_">Text</span>(sections[<span class="number">0</span>].trim()),<span class="keyword">new</span> <span class="title class_">Text</span>(sections[<span class="number">1</span>].trim()));</span><br><span class="line">		&#125;<span class="keyword">else</span></span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IOException</span>(<span class="string">&quot;Incorrect data format&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="InitReducer-java"><a href="#InitReducer-java" class="headerlink" title="InitReducer.java"></a>InitReducer.java</h3><ul>
<li>input: key &#x3D; nodeIdentifier, values &#x3D; vertexes the node links to </li>
<li>emit: key &#x3D; nodeIdentifier+rank_value, value &#x3D; adjacency list</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InitReducer</span> <span class="keyword">extends</span> <span class="title class_">Reducer</span>&lt;Text, Text, Text, Text&gt; &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reduce</span><span class="params">(Text key, Iterable&lt;Text&gt; values, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">		<span class="comment">/* </span></span><br><span class="line"><span class="comment">		 * <span class="doctag">TODO:</span> Output key: node+rank, value: adjacency list</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		<span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">		<span class="keyword">for</span> (Text val : values)&#123;</span><br><span class="line">			sb.append(val.toString() + <span class="string">&quot; &quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		context.write(<span class="keyword">new</span> <span class="title class_">Text</span>(key.toString() + PageRankDriver.MARKER_DELIMITER + <span class="string">&quot;1.0&quot;</span>), <span class="keyword">new</span> <span class="title class_">Text</span>(sb.toString().trim()));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="IterMapper-java"><a href="#IterMapper-java" class="headerlink" title="IterMapper.java"></a>IterMapper.java</h3><ul>
<li>input nodeIdentifier+rank_value | adjacency list</li>
<li>emit key &#x3D; adj vertex, value &#x3D; computed weight</li>
<li>emit key &#x3D;  this vertex, value &#x3D; adj List</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IterMapper</span> <span class="keyword">extends</span> <span class="title class_">Mapper</span>&lt;LongWritable, Text, Text, Text&gt; &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">map</span><span class="params">(LongWritable key, Text value, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException,</span><br><span class="line">			IllegalArgumentException &#123;</span><br><span class="line">		<span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> value.toString(); <span class="comment">// Converts Line to a String</span></span><br><span class="line">		String[] sections = line.split(<span class="string">&quot;\t&quot;</span>); <span class="comment">// Splits it into two parts. Part 1: node+rank | Part 2: adj list</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (sections.length &gt; <span class="number">2</span>) <span class="comment">// Checks if the data is in the incorrect format</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IOException</span>(<span class="string">&quot;Incorrect data format&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (sections.length != <span class="number">2</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">/* </span></span><br><span class="line"><span class="comment">		 * <span class="doctag">TODO:</span> emit key: adj vertex, value: computed weight.</span></span><br><span class="line"><span class="comment">		 * </span></span><br><span class="line"><span class="comment">		 * Remember to also emit the input adjacency list for this node!</span></span><br><span class="line"><span class="comment">		 * Put a marker on the string value to indicate it is an adjacency list.</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		String[] pair = sections[<span class="number">0</span>].split(<span class="string">&quot;\\&quot;</span>+PageRankDriver.MARKER_DELIMITER);</span><br><span class="line">		<span class="type">double</span> <span class="variable">rank</span> <span class="operator">=</span> Double.valueOf(pair[<span class="number">1</span>]);</span><br><span class="line">		String[] adjList = sections[<span class="number">1</span>].split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">		<span class="type">double</span> <span class="variable">weight</span> <span class="operator">=</span> rank / adjList.length;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; adjList.length; i++)&#123;</span><br><span class="line">			context.write(<span class="keyword">new</span> <span class="title class_">Text</span>(adjList[i]), <span class="keyword">new</span> <span class="title class_">Text</span>(String.valueOf(weight)));</span><br><span class="line">		&#125;</span><br><span class="line">		context.write(<span class="keyword">new</span> <span class="title class_">Text</span>(pair[<span class="number">0</span>]), <span class="keyword">new</span> <span class="title class_">Text</span>(PageRankDriver.MARKER_ADJ + <span class="string">&quot;:&quot;</span> + sections[<span class="number">1</span>]));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="IterReducer-java"><a href="#IterReducer-java" class="headerlink" title="IterReducer.java"></a>IterReducer.java</h3><ul>
<li>input key &#x3D; node, values &#x3D; rankValues form adj vertexes Or adjacency list </li>
<li>emit key &#x3D; node+rank, value &#x3D; adjacency list</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IterReducer</span> <span class="keyword">extends</span> <span class="title class_">Reducer</span>&lt;Text, Text, Text, Text&gt; &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reduce</span><span class="params">(Text key, Iterable&lt;Text&gt; values, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">		<span class="type">double</span> <span class="variable">d</span> <span class="operator">=</span> PageRankDriver.DECAY; <span class="comment">// Decay factor</span></span><br><span class="line">		<span class="comment">/* </span></span><br><span class="line"><span class="comment">		 * <span class="doctag">TODO:</span> emit key:node+rank, value: adjacency list</span></span><br><span class="line"><span class="comment">		 * Use PageRank algorithm to compute rank from weights contributed by incoming edges.</span></span><br><span class="line"><span class="comment">		 * Remember that one of the values will be marked as the adjacency list for the node.</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		<span class="type">double</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">adjList</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">		<span class="keyword">for</span> (Text val:values)&#123;</span><br><span class="line">			<span class="type">String</span> <span class="variable">val_s</span> <span class="operator">=</span> val.toString();</span><br><span class="line">			<span class="keyword">if</span> (val_s.startsWith(PageRankDriver.MARKER_ADJ))</span><br><span class="line">				adjList = val_s.split(<span class="string">&quot;:&quot;</span>)[<span class="number">1</span>];</span><br><span class="line">			<span class="keyword">else</span> sum += Double.valueOf(val.toString());</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="type">double</span> <span class="variable">value</span> <span class="operator">=</span> (<span class="number">1</span>-d) + d * sum;</span><br><span class="line">		context.write(<span class="keyword">new</span> <span class="title class_">Text</span>(key.toString() + PageRankDriver.MARKER_DELIMITER + String.valueOf(value)), <span class="keyword">new</span> <span class="title class_">Text</span>(adjList));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="DiffMap1-java"><a href="#DiffMap1-java" class="headerlink" title="DiffMap1.java"></a>DiffMap1.java</h3><ul>
<li>input node+rank (‘+’ is the delimiter)</li>
<li>emit key &#x3D; node, value &#x3D; rank</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DiffMap1</span> <span class="keyword">extends</span> <span class="title class_">Mapper</span>&lt;LongWritable, Text, Text, Text&gt; &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">map</span><span class="params">(LongWritable key, Text value, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException,</span><br><span class="line">			IllegalArgumentException &#123;</span><br><span class="line">		<span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> value.toString(); <span class="comment">// Converts Line to a String</span></span><br><span class="line">		String[] sections = line.split(<span class="string">&quot;\t&quot;</span>); <span class="comment">// Splits each line</span></span><br><span class="line">		<span class="keyword">if</span> (sections.length &gt; <span class="number">2</span>) <span class="comment">// checks for incorrect data format</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IOException</span>(<span class="string">&quot;Incorrect data format&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">/**</span></span><br><span class="line"><span class="comment">		 *  <span class="doctag">TODO:</span> read node-rank pair and emit: key:node, value:rank</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		String[] pair = sections[<span class="number">0</span>].split(<span class="string">&quot;//&quot;</span>+PageRankDriver.MARKER_DELIMITER);</span><br><span class="line">		<span class="keyword">if</span> (pair.length == <span class="number">2</span>)</span><br><span class="line">			context.write(<span class="keyword">new</span> <span class="title class_">Text</span>(pair[<span class="number">0</span>]), <span class="keyword">new</span> <span class="title class_">Text</span>(pair[<span class="number">1</span>]));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="DiffRed1-java"><a href="#DiffRed1-java" class="headerlink" title="DiffRed1.java"></a>DiffRed1.java</h3><ul>
<li>input key &#x3D; node , values &#x3D; 2 ranks</li>
<li>emit key &#x3D; difference, value &#x3D; “”</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DiffRed1</span> <span class="keyword">extends</span> <span class="title class_">Reducer</span>&lt;Text, Text, Text, Text&gt; &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reduce</span><span class="params">(Text key, Iterable&lt;Text&gt; values, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">		<span class="type">double</span>[] ranks = <span class="keyword">new</span> <span class="title class_">double</span>[<span class="number">2</span>];</span><br><span class="line">		<span class="comment">/* </span></span><br><span class="line"><span class="comment">		 * <span class="doctag">TODO:</span> The list of values should contain two ranks.  Compute and output their difference.</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (Text val: values)&#123;</span><br><span class="line">			ranks[i++] = Double.valueOf(val.toString());</span><br><span class="line">			<span class="keyword">if</span> (i &gt;= <span class="number">2</span>) <span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		context.write(<span class="keyword">new</span> <span class="title class_">Text</span>(String.valueOf(Math.abs(ranks[<span class="number">0</span>] - ranks[<span class="number">1</span>]))), <span class="keyword">new</span> <span class="title class_">Text</span>());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="DiffMap2-java"><a href="#DiffMap2-java" class="headerlink" title="DiffMap2.java"></a>DiffMap2.java</h3><ul>
<li>input difference from DiffRed1</li>
<li>emit: key &#x3D; “Difference” value &#x3D; difference</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DiffMap2</span> <span class="keyword">extends</span> <span class="title class_">Mapper</span>&lt;LongWritable, Text, Text, Text&gt; &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">map</span><span class="params">(LongWritable key, Text value, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException,</span><br><span class="line">			IllegalArgumentException &#123;</span><br><span class="line">		<span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> value.toString(); <span class="comment">// Converts Line to a String</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">/* </span></span><br><span class="line"><span class="comment">		 * <span class="doctag">TODO:</span> emit: key:&quot;Difference&quot; value:difference calculated in DiffRed1</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		context.write(<span class="keyword">new</span> <span class="title class_">Text</span>(<span class="string">&quot;Difference&quot;</span>), <span class="keyword">new</span> <span class="title class_">Text</span>(s.trim()));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="DiffRed2-java"><a href="#DiffRed2-java" class="headerlink" title="DiffRed2.java"></a>DiffRed2.java</h3><ul>
<li>input difference</li>
<li>emit max_difference</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DiffRed2</span> <span class="keyword">extends</span> <span class="title class_">Reducer</span>&lt;Text, Text, Text, Text&gt; &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reduce</span><span class="params">(Text key, Iterable&lt;Text&gt; values, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">		<span class="type">double</span> <span class="variable">diff_max</span> <span class="operator">=</span> <span class="number">0.0</span>; <span class="comment">// sets diff_max to a default value</span></span><br><span class="line">		<span class="comment">/* </span></span><br><span class="line"><span class="comment">		 * <span class="doctag">TODO:</span> Compute and emit the maximum of the differences</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		<span class="keyword">for</span> (Text val: values)&#123;</span><br><span class="line">			<span class="type">double</span> <span class="variable">diff</span> <span class="operator">=</span> Double.valueOf(val.toString());</span><br><span class="line">			diff_max = Math.max(diff, diff_max);</span><br><span class="line">		&#125;</span><br><span class="line">		context.write(<span class="keyword">new</span> <span class="title class_">Text</span>(String.valueOf(diff_max)), <span class="keyword">new</span> <span class="title class_">Text</span>());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="FinMapper-java"><a href="#FinMapper-java" class="headerlink" title="FinMapper.java"></a>FinMapper.java</h3><ul>
<li>input node+rank | adjList</li>
<li>emit key &#x3D; -rank, value &#x3D; node</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FinMapper</span> <span class="keyword">extends</span> <span class="title class_">Mapper</span>&lt;LongWritable, Text, DoubleWritable, Text&gt; &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">map</span><span class="params">(LongWritable key, Text value, Context context)</span></span><br><span class="line">			<span class="keyword">throws</span> IOException, InterruptedException, IllegalArgumentException &#123;</span><br><span class="line">		<span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> value.toString(); <span class="comment">// Converts Line to a String</span></span><br><span class="line">		<span class="comment">/*</span></span><br><span class="line"><span class="comment">		 * TODO output key:-rank, value: node</span></span><br><span class="line"><span class="comment">		 * See IterMapper for hints on parsing the output of IterReducer.</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		String[] sections = line.split(<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">		String[] pair = sections[<span class="number">0</span>].split(<span class="string">&quot;\\&quot;</span> + PageRankDriver.MARKER_DELIMITER);</span><br><span class="line">		<span class="keyword">if</span> (pair.length == <span class="number">2</span> &amp;&amp; pair[<span class="number">1</span>] != <span class="literal">null</span> &amp;&amp; !pair[<span class="number">1</span>].equals(<span class="string">&quot;null&quot;</span>))</span><br><span class="line">			context.write(<span class="keyword">new</span> <span class="title class_">DoubleWritable</span>(-Double.valueOf(pair[<span class="number">1</span>])), <span class="keyword">new</span> <span class="title class_">Text</span>(pair[<span class="number">0</span>]));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="FinReducer-java"><a href="#FinReducer-java" class="headerlink" title="FinReducer.java"></a>FinReducer.java</h3><ul>
<li>input key &#x3D; -rank, values &#x3D; node</li>
<li>emit key &#x3D; node, value &#x3D; rank<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FinReducer</span> <span class="keyword">extends</span> <span class="title class_">Reducer</span>&lt;DoubleWritable, Text, Text, Text&gt; &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reduce</span><span class="params">(DoubleWritable key, Iterable&lt;Text&gt; values, Context context)</span> <span class="keyword">throws</span> IOException,</span><br><span class="line">			InterruptedException &#123;</span><br><span class="line">		<span class="comment">/* </span></span><br><span class="line"><span class="comment">		 * <span class="doctag">TODO:</span> For each value, emit: key:value, value:-rank</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		<span class="keyword">for</span> (Text val:values)&#123;</span><br><span class="line">			context.write(<span class="keyword">new</span> <span class="title class_">Text</span>(val), <span class="keyword">new</span> <span class="title class_">Text</span>(String.valueOf(-Double.valueOf(key.toString()))));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="TranslateMap-java"><a href="#TranslateMap-java" class="headerlink" title="TranslateMap.java"></a>TranslateMap.java</h3><ul>
<li>input node+rank | adjList Or node: name</li>
<li>emit key &#x3D; node, value &#x3D; “NAME” + name</li>
<li>emit key &#x3D; node, value &#x3D; “RANK” + rank</li>
<li>emit key &#x3D; node, value &#x3D; “ADJADENCY” + adjList</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TranslateMap</span> <span class="keyword">extends</span> <span class="title class_">Mapper</span>&lt;LongWritable, Text, Text, Text&gt; &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">map</span><span class="params">(LongWritable key, Text value, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException, IllegalArgumentException &#123;</span><br><span class="line">		<span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> value.toString();		</span><br><span class="line">		<span class="keyword">if</span> (line.contains(<span class="string">&quot;:&quot;</span>)) &#123;</span><br><span class="line">			<span class="comment">//value = node : NAME</span></span><br><span class="line">			String[] sections = line.split(<span class="string">&quot;: &quot;</span>);		</span><br><span class="line">			<span class="keyword">if</span> (sections.length &gt;= <span class="number">2</span>) &#123;</span><br><span class="line">				context.write(<span class="keyword">new</span> <span class="title class_">Text</span>(sections[<span class="number">0</span>]), </span><br><span class="line">						<span class="keyword">new</span> <span class="title class_">Text</span>(<span class="string">&quot;NAME&quot;</span> + PageRankDriver.MARKER_DELIMITER + line.substring(line.indexOf(<span class="string">&#x27;:&#x27;</span>) + <span class="number">1</span>).trim()));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="comment">// value = node+rank | adjList</span></span><br><span class="line">			String[] sections = line.split(<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">			String[] pair = sections[<span class="number">0</span>].trim().split(<span class="string">&quot;\\&quot;</span>+PageRankDriver.MARKER_DELIMITER);</span><br><span class="line">			<span class="type">String</span> <span class="variable">rank</span> <span class="operator">=</span> pair[<span class="number">1</span>];</span><br><span class="line">			<span class="type">String</span> <span class="variable">list</span> <span class="operator">=</span> (sections.length &gt; <span class="number">1</span>) ? sections[<span class="number">1</span>].trim() : <span class="string">&quot;&quot;</span>;</span><br><span class="line">			context.write(<span class="keyword">new</span> <span class="title class_">Text</span>(pair[<span class="number">0</span>]), <span class="keyword">new</span> <span class="title class_">Text</span>(<span class="string">&quot;RANK&quot;</span> + PageRankDriver.MARKER_DELIMITER + rank));</span><br><span class="line">			context.write(<span class="keyword">new</span> <span class="title class_">Text</span>(pair[<span class="number">0</span>]), <span class="keyword">new</span> <span class="title class_">Text</span>(PageRankDriver.MARKER_ADJ + PageRankDriver.MARKER_DELIMITER + list));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="TranslateRed-java"><a href="#TranslateRed-java" class="headerlink" title="TranslateRed.java"></a>TranslateRed.java</h3><ul>
<li>input node | “NAME” + name</li>
<li>input node | “RANK” + rank</li>
<li>input node | “ADJADENCY” + adjList</li>
<li>emit key &#x3D; name Or node(if can’t match any name), value &#x3D; adjList</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TranslateRed</span> <span class="keyword">extends</span> <span class="title class_">Reducer</span>&lt;Text, Text, Text, Text&gt; &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reduce</span><span class="params">(Text key, Iterable&lt;Text&gt; values, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">		<span class="type">String</span> <span class="variable">node</span> <span class="operator">=</span> key.toString();</span><br><span class="line">		<span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">rank</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">list</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">		<span class="keyword">for</span>(Text val : values) &#123;</span><br><span class="line">			<span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> val.toString();</span><br><span class="line">			String[] pair = value.split(<span class="string">&quot;\\&quot;</span>+PageRankDriver.MARKER_DELIMITER);</span><br><span class="line">			<span class="keyword">if</span> (value.startsWith(<span class="string">&quot;NAME&quot;</span>)) &#123;</span><br><span class="line">				name = (pair.length &gt; <span class="number">1</span>) ? pair[<span class="number">1</span>]:<span class="literal">null</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (value.startsWith(<span class="string">&quot;RANK&quot;</span>)) &#123;</span><br><span class="line">				rank = (pair.length &gt; <span class="number">1</span>) ? pair[<span class="number">1</span>]:<span class="literal">null</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (value.startsWith(PageRankDriver.MARKER_ADJ)) &#123;</span><br><span class="line">				list = (pair.length &gt; <span class="number">1</span>) ? pair[<span class="number">1</span>]:<span class="literal">null</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="type">String</span> <span class="variable">outKey</span> <span class="operator">=</span> ((name == <span class="literal">null</span>)? node : name) + PageRankDriver.MARKER_DELIMITER + rank;</span><br><span class="line">		<span class="type">String</span> <span class="variable">outValue</span> <span class="operator">=</span> (list == <span class="literal">null</span>)? <span class="string">&quot;&quot;</span> : list;</span><br><span class="line">		context.write(<span class="keyword">new</span> <span class="title class_">Text</span>(outKey), <span class="keyword">new</span> <span class="title class_">Text</span>(outValue));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h2><h3 id="Local"><a href="#Local" class="headerlink" title="Local"></a>Local</h3><p>I test using the example graph in pdf.<br>Graph:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1 : 2 3</span><br><span class="line">2 : 4</span><br><span class="line">3 : 1 4 5</span><br><span class="line">5 : 1 4</span><br></pre></td></tr></table></figure>
<p>Name:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1: amazon</span><br><span class="line">2: pixer</span><br><span class="line">3: java</span><br><span class="line">4: google</span><br><span class="line">5: Ac Fun</span><br></pre></td></tr></table></figure>
<p>Output:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">google	1.708333333333333</span><br><span class="line">amazon	0.8583333333333333</span><br><span class="line">pixer	0.575</span><br><span class="line">java	0.575</span><br><span class="line">Ac Fun	0.43333333333333335</span><br></pre></td></tr></table></figure>

<h2 id="EMR"><a href="#EMR" class="headerlink" title="EMR"></a>EMR</h2><p>Result(5 reducers):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">United_States_postal_abbreviations	17400.21276502926</span><br><span class="line">United_States	13078.758142261851</span><br><span class="line">Geographic_coordinate_system	11721.388760989967</span><br><span class="line">Biography	9046.94404539674</span><br><span class="line">2008	7074.6425361942565</span><br><span class="line">2007	6800.352714147496</span><br><span class="line">United_Kingdom	4910.857511340169</span><br><span class="line">Music_genre	4873.710868083095</span><br><span class="line">France	4742.359910022161</span><br><span class="line">Record_label	4693.041866616612</span><br><span class="line">Biological_classification	4504.695513826754</span><br><span class="line">England	4235.032041106078</span><br><span class="line">Canada	3690.885542951598</span><br><span class="line">Personal_name	3576.978399648568</span><br><span class="line">2006	3575.6745346145035</span><br><span class="line">Internet_Movie_Database	3463.2832928822127</span><br><span class="line">India	3106.5889721148874</span><br><span class="line">Binomial_nomenclature	2900.531729940027</span><br><span class="line">Germany	2813.7080608753836</span><br><span class="line">Australia	2801.5539246554167</span><br><span class="line">2005	2753.2105256013992</span><br><span class="line">Japan	2738.5863561278975</span><br><span class="line">Studio_album	2653.126455458513</span><br><span class="line">Village	2443.744194498339</span><br><span class="line">Record_producer	2390.2859118177685</span><br><span class="line">Football_(soccer)	2309.2199488266556</span><br><span class="line">Politician	2297.477993147134</span><br><span class="line">Romania	2223.1518281845247</span><br><span class="line">English_language	2213.6348292720913</span><br><span class="line">Time_zone	1995.897478274637</span><br><span class="line">Departments_of_France	1989.2385407660036</span><br><span class="line">Wiktionary	1986.601595665923</span><br><span class="line">Geocode	1957.2310712914546</span><br><span class="line">UN/LOCODE	1927.7685672468049</span><br><span class="line">2004	1923.7717011191974</span><br><span class="line">Television	1887.5449027795114</span><br><span class="line">Italy	1876.5179226178395</span><br><span class="line">Europe	1876.4133549775547</span><br><span class="line">Album	1862.5000237009542</span><br><span class="line">Conservation_status	1822.3255838594016</span><br><span class="line">Website	1786.3698129091722</span><br><span class="line">Animal	1755.4690932603446</span><br><span class="line">London	1750.4268351247983</span><br><span class="line">IUCN_Red_List	1693.081548359981</span><br><span class="line">Wikimedia_Commons	1691.2920868385286</span><br><span class="line">Poland	1660.9849679859221</span><br><span class="line">Population_density	1594.3872097107585</span><br><span class="line">Public_domain	1524.3655342422294</span><br><span class="line">Actor	1430.0997921719966</span><br><span class="line">Digital_object_identifier	1394.3430354664986</span><br><span class="line">2001	1372.891851411744</span><br><span class="line">Elevation	1359.6035580473917</span><br><span class="line">Norway	1354.81422265507</span><br><span class="line">China	1290.9928602406003</span><br><span class="line">School	1176.2465753102497</span><br></pre></td></tr></table></figure>

<h3 id="5-reducers-10-reducers-20-reducers"><a href="#5-reducers-10-reducers-20-reducers" class="headerlink" title="5 reducers ,10 reducers, 20 reducers"></a>5 reducers ,10 reducers, 20 reducers</h3><ul>
<li>1 master, 4 cores, spent 9 mins.</li>
<li>1 master, 9 cores, spent 6 mins 11 secs (first)</li>
<li>1 master, 9 cores, spent 5 mins 30 secs (second)</li>
<li>1 master, 19 cores, spent 4 mins 25secs（first）.</li>
<li>1 master, 19 cores, spent 4 mins 52secs (second)</li>
</ul>
<p>According to the different number reducers’ different time, we know that running twice with the exact same arguments<br>still show a notable difference. And we use the double reducers from 10 to 20, but the time cost didn’t improve as much as that. Because if we have too more reducers, more time will spend on comunication and calling function, rather than the benifit of increasing reducer. That means adding reducers may slow overall time.</p>
</article><div class="post-copyright"><div class="post-copyright__author_group"><a class="post-copyright__author_img" href="/about/"><img class="post-copyright__author_img_front" src="/img/pwa/favicon.png"></a><div class="post-copyright__author_name">Ankai Liang's Blog</div><div class="post-copyright__author_desc">Strong but not aggressive, weak but not feeble.</div></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div id="quit-box" onclick="RemoveRewardMask()"></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">This piece of writing is an original article, utilizing the<a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0</a>Agreement. For complete reproduction, please acknowledge the source as Courtesy of<a href="/">Ankai Liang's Blog</a></span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Distrubute-System/"><span class="tags-punctuation"></span>Distrubute System<span class="tagsPageCount">2</span></a></div></div></div><nav class="needEndHide pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2017/08/17/DHT-REMOTE/"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">DHT-REMOTE</div></div></a></div><div class="next-post pull-right"><a href="/2017/08/17/RushHour/"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">RushHour</div></div></a></div></nav><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="solitude st-chat-fill"></i><span> Comment</span><span></span></div></div><div class="comment-wrap"><div id="comment"></div><script>async function initComment() {
    const isLazyLoad = !true;
    let walineInitFunction = window.walineFn || null;

    async function initWaline(Fn) {
        const walineOptions = {
            el: '#comment',
            serverURL: 'https://waline-comment-five-smoky.vercel.app/',
            pageview: !isLazyLoad,
            dark: 'html[data-theme="dark"]',
            path: window.location.pathname,
            comment: !isLazyLoad,
            ...null
        };
        const walineInstance = Fn(walineOptions);

        utils.addGlobalFn('pjax', () => walineInstance.destroy(), 'destroyWaline');
    }

    async function loadWalineCSSAndJS() {
        if (!walineInitFunction) {
            await getCSS('https://cdn.staticfile.net/waline/3.1.3/waline.min.css');
            const {init} = await import('https://cdn.staticfile.net/waline/3.1.3/waline.min.js');
            walineInitFunction = init || Waline.init;
            window.walineFn = walineInitFunction;
        }
        initWaline(walineInitFunction);
    }

    if (isLazyLoad) {
        utils.loadComment(document.getElementById('comment'),loadWalineCSSAndJS);
    } else {
        await loadWalineCSSAndJS();
    }

    if (GLOBAL_CONFIG.lightbox) {
        utils.lightbox(document.querySelectorAll('#comment .wl-content img:not(.wl-emoji)'));
    }

    sco.owoBig();
}</script></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><div class="author-info__top-group"><div class="author-info__sayhi" id="author-info__sayhi" onclick="sco.changeSayHelloText()">sayhello.morning</div></div></div><div class="avatar-img-group"><img class="avatar-img" alt="Avatar" src="/img/avatar.png"><div class="avatar-sticker"><img class="avatar-sticker-img" src="https://7.isyangs.cn/34/65f2e4e0423cc-34.png" alt="Mood sticker"></div></div><div class="author-info__description_group"><div class="author-info__description">Share my <b>journey</b> of exploring the ocean of knowledge.</div><div class="author-info__description2">Hope you find something you like</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/about/"><div class="author-info__name">Ankai Liang</div><div class="author-info__desc">Strong but not aggressive, weak but not feeble.</div></a><div class="card-info-social-icons is-center"><a class="social-icon" target="_blank" rel="noopener" href="https://github.com/ankaiLiang" title="Github"><i class="solitude  st-github-line"></i></a><a class="social-icon" target="_blank" rel="noopener" href="https://www.instagram.com/ankai_liang/" title="Instagram"><i class="solitude  st-image-fill"></i></a><a class="social-icon" target="_blank" rel="noopener" href="https://www.linkedin.com/in/ankai-liang-a774b3119?trk=hp-identity-name" title="LinkedIn"><i class="solitude  st-contacts-fill"></i></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="solitude st-menu-line"></i><span>Table of contents</span></div><div class="toc-content" id="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#PageRank-Hadoop"><span class="toc-text">PageRank-Hadoop</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Code-Explanation"><span class="toc-text">Code Explanation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PageRankDriver-java"><span class="toc-text">PageRankDriver.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InitMapper-java"><span class="toc-text">InitMapper.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InitReducer-java"><span class="toc-text">InitReducer.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IterMapper-java"><span class="toc-text">IterMapper.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IterReducer-java"><span class="toc-text">IterReducer.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DiffMap1-java"><span class="toc-text">DiffMap1.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DiffRed1-java"><span class="toc-text">DiffRed1.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DiffMap2-java"><span class="toc-text">DiffMap2.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DiffRed2-java"><span class="toc-text">DiffRed2.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FinMapper-java"><span class="toc-text">FinMapper.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FinReducer-java"><span class="toc-text">FinReducer.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TranslateMap-java"><span class="toc-text">TranslateMap.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TranslateRed-java"><span class="toc-text">TranslateRed.java</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Test"><span class="toc-text">Test</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Local"><span class="toc-text">Local</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EMR"><span class="toc-text">EMR</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-reducers-10-reducers-20-reducers"><span class="toc-text">5 reducers ,10 reducers, 20 reducers</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="solitude st-map-line"></i><span>New posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/02/03/a-New-Generation-Search-Engine-with-Multimodal-Deep-Learning/" title="a New Generation Search Engine with Multimodal Deep Learning"><img alt="a New Generation Search Engine with Multimodal Deep Learning" src="/img/default.png"></a><div class="content"><a class="title" href="/2024/02/03/a-New-Generation-Search-Engine-with-Multimodal-Deep-Learning/" title="a New Generation Search Engine with Multimodal Deep Learning">a New Generation Search Engine with Multimodal Deep Learning</a></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/08/17/Semi-Structured-Search/" title="Semi-Structured Search"><img alt="Semi-Structured Search" src="/img/default4.png"></a><div class="content"><a class="title" href="/2023/08/17/Semi-Structured-Search/" title="Semi-Structured Search">Semi-Structured Search</a></div></div><div class="aside-list-item"><a class="thumbnail" href="/2017/08/17/DHT-REMOTE/" title="DHT-REMOTE"><img alt="DHT-REMOTE" src="/img/default3.png"></a><div class="content"><a class="title" href="/2017/08/17/DHT-REMOTE/" title="DHT-REMOTE">DHT-REMOTE</a></div></div><div class="aside-list-item"><a class="thumbnail" href="/2017/08/17/Page-Rank-Hadoop/" title="Page Rank - Hadoop"><img alt="Page Rank - Hadoop" src="/img/default3.png"></a><div class="content"><a class="title" href="/2017/08/17/Page-Rank-Hadoop/" title="Page Rank - Hadoop">Page Rank - Hadoop</a></div></div><div class="aside-list-item"><a class="thumbnail" href="/2017/08/17/RushHour/" title="RushHour"><img alt="RushHour" src="/img/default5.png"></a><div class="content"><a class="title" href="/2017/08/17/RushHour/" title="RushHour">RushHour</a></div></div></div></div></div></div></main><footer id="footer"><div id="st-footer-bar"><div class="footer-logo"><span class="solitude">Ankai Liang / ex-Googler / ByteDancer</span></div><div class="footer-bar-description">Article from Ankai Liang's Blog - Strong but not aggressive, weak but not feeble.</div><a class="footer-bar-link" href="/">Learn more</a></div><div id="footer_deal"><div class="nolazyload footer_mini_logo" id="footer_mini_logo" title="Back to top" onclick="sco.toTop()"><img src="/img/pwa/favicon.png" alt="Back to top"></div></div><div id="st-footer"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div class="copyright">© 2017 - 2024 By&nbsp;<a class="footer-bar-link" href="/">Ankai Liang</a></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/valor-x/hexo-theme-solitude" title="主题">主题</a><a class="footer-bar-link cc" href="/null" aria-label="copyright"><i class="solitude st-copyright-line"></i><i class="solitude st-creative-commons-by-line"></i><i class="solitude st-creative-commons-nc-line"></i><i class="solitude st-creative-commons-nd-line"></i></a></div></div></div></footer></div><!-- inject body--><div><script src="/js/main.js?v=1.7.8"></script><script src="/js/utils.js?v=1.7.8"></script><script src="/js/third_party/universe.min.js?v=1.7.8"></script><script>dark()
</script><script src="https://cdn.staticfile.net/pjax/0.2.8/pjax.min.js"></script><script src="https://cdn.staticfile.net/node-snackbar/0.1.16/snackbar.min.js"></script><script src="/js/third_party/efu_ai.min.js?v=1.7.8"></script><script src="https://cdn.staticfile.net/pace/1.2.4/pace.min.js"></script></div><div id="js-pjax"><script id="config-diff">var PAGE_CONFIG = {
    is_post: true,
    is_page: false,
    is_home: false,
    page: 'post',
    toc: true,
    comment: true,
}
</script></div><!-- newest comment--><!-- pjax--><script>let pjaxSelectors = [
    'title',
    '#body-wrap',
    '#site-config',
    'meta[name="description"]',
    '#js-pjax',
    'meta[property^="og:"]',
]

const pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
})

document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
})

document.addEventListener('pjax:complete', () => {
    window.refreshFn()
})

document.addEventListener('pjax:error', (e) => {
    if (e.request.status === 404) {
        pjax.loadUrl('/404.html')
    }
})</script><!-- theme--><script>initTheme = () => {
    let isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const cachedMode = saveToLocal.get('theme');
    if (cachedMode === undefined) {
        const nowMode =
            isDarkMode ? 'dark' : 'light'
        document.documentElement.setAttribute('data-theme', nowMode);
    } else {
        document.documentElement.setAttribute('data-theme', cachedMode);
    }
}
initTheme()</script><!-- google adsense--><!-- search--><!-- music--></body></html><script>const posts=["2024/02/03/a-New-Generation-Search-Engine-with-Multimodal-Deep-Learning/","2023/08/17/Semi-Structured-Search/","2017/08/17/DHT-REMOTE/","2017/08/17/Page-Rank-Hadoop/","2017/08/17/RushHour/","2017/08/17/Text-processing-in-Linux/","2017/08/17/afewmore-A-tool-of-ec2-how-to-write-a-shell-tool/","2017/08/16/tcpdump-1-DNS/","2017/08/16/Using-Manages-packages-in-Linux/","2017/08/16/Using-the-AWS-CLI-to-set-instance/","2017/05/19/Install and Configure AWS Tools/"];function toRandomPost(){ pjax.loadUrl('/'+posts[Math.floor(Math.random()*posts.length)]); }</script>